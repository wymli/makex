interpreter: sh  # see https://pubs.opengroup.org/onlinepubs/9699919799/utilities/contents.html

# user defined functions
udfs: []

cmds:
  - name: upload
    usage: upload something
    cmds:
      - name: asciinema
        usage: upload asciinema to asciinema.org
        cmd: |
          curl -v -u $USER:$(cat ~/.config/asciinema/install-id) https://asciinema.org/api/asciicasts -F asciicast=@$pwd/makex.cast
  - build:
    usage: build go exe
    cmd: |
      VERSION=`git describe --tags`
      BUILD=`date +%FT%T%z`
      CGO_ENABLED=0 go build -a -ldflags "-X cmd.AppVersion=$VERSION cmd.AppBuildTime=$BUILD"